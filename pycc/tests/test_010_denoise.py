# Import required packages
from pycc.rt.utils import denoise
import numpy as np
import pytest


def test_denoise():
    # Define function
    np.random.seed(10)
    timestep = 0.001
    t = np.arange(0, 1, timestep)
    f = np.cos(2*np.pi*12*t) + np.sin(2*np.pi*50*t)
    f = f + np.random.randn(len(t))

    valid_list = [1.0093550465431027, 1.315113837280485, 1.5815370383958445, 1.7820105023426902, 1.8958707690136203, 1.9104336570867082, 1.8222446235258363, 1.637428447653256, 1.3711039447690005, 1.0459209202564086, 0.6898624813324025, 0.3335277210611803, 0.007160640208489554, -0.2622840005969795, -0.4537508332626285, -0.5541147004776863, -0.5594335209270771, -0.4753007436537338, -0.3162630808026479, -0.10436071253064308, 0.13306693723120394, 0.366094859227039, 0.5651797067432915, 0.7040899621911927, 0.7625119798945851, 0.7280765897209288, 0.5976076666252212, 0.3774702326959913, 0.08298380566739076, -0.2630417874065471, -0.6325050076766844, -0.9947305934372452, -1.3194410710769569, -1.5796910931170423, -1.75447753712286, -1.8307700270793867, -1.804763260038858, -1.6822286832811153, -1.477931215636164, -1.2141682125000361, -0.9185737802762023, -0.6214034434815047, -0.3525650188254506, -0.13868637763647543, -0.000507150913118835, 0.04915029484055788, 0.006632002311077145, -0.1221967594401932, -0.3225353067685581, -0.5721087796529446, -0.8433636994312824, -1.1061828435516612, -1.3308535856336825, -1.4909990239318123, -1.5661848502249693, -1.5439466390761836, -1.4210389586361538, -1.2037838665043328, -0.9074845023738131, -0.5549609947688838, -0.17435180498524344, 0.20360447164917192, 0.5485409765996053, 0.833397434065437, 1.037030902937475, 1.1462470926510364, 1.1570536212287597, 1.075012755461311, 0.9146593208352132, 0.6980409739849842, 0.4525239359727198, 0.20807918157197436, -0.005685069784541383, -0.1624538892072085, -0.2418121550969604, -0.23127173338272564, -0.12752072304217585, 0.06322767034609114, 0.3258209234387673, 0.6376304325581338, 0.970749081469465, 1.2947081255714175, 1.5794475293757841, 1.7982490690187019, 1.9303451406106016, 1.9629479433483394, 1.8925004278020938, 1.7250265624497005, 1.4755466201233942, 1.1666146920532914, 0.8261215434845788, 0.4845778223967111, 0.17214348392029774, -0.08430587993743961, -0.26378874283980136, -0.35324804278275906, -0.3488036603777065, -0.25610452113374743, -0.08974601297339746, 0.12819008544311897, 0.37033006532644314, 0.6067221410209606, 0.8078038500207079, 0.9473323281716352, 1.0049904169328645, 0.9684132869684927, 0.8344369830262396, 0.6094464568322524, 0.30878880235901984, -0.04469108719405512, -0.42284931617826665, -0.7949612161138556, -1.1306931373802969, -1.4030371064575824, -1.5909212806915198, -1.6812408601512103, -1.6701108371682256, -1.5632181263950782, -1.3752387664590278, -1.1283773900129894, -0.8501720650460645, -0.5707795076989036, -0.3200065177919033, -0.12437831524958438, -0.0045308284375211085, 0.026817740743194124, -0.033882530331996466, -0.18066305897270934, -0.39862115601378717, -0.6653818436379636, -0.9532939820005324, -1.2321456989108257, -1.4721332677116952, -1.6467927533928082, -1.7356073760206094, -1.7260352686186997, -1.6147590280096689, -1.4080346196316247, -1.1211053457319236, -0.7767380921130282, -0.40302497460848946, -0.03066540368793335, 0.31000556371217325, 0.5919518894264558, 0.7940471682948441, 0.9031058500550928, 0.9151364477214495, 0.8356942726798438, 0.6792993841377102, 0.467976945481072, 0.22906308536524705, -0.007508742010210597, -0.21217505275443058, -0.35867261429119873, -0.4266446683576542, -0.4036677796096127, -0.28650071351124345, -0.08143290834617847, 0.19630174678813955, 0.523988611747203, 0.8736303519932107, 1.2146643354238478, 1.5169335033395548, 1.7536200242599715, 1.9038546682642368, 1.9547465675624993, 1.9026347504299934, 1.7534389982485858, 1.5220757239653786, 1.230996076288776, 0.9079893802456179, 0.5834669223039332, 0.2874919393817536, 0.04684649814475006, -0.11757767611125655, -0.19280908785501458, -0.17504846339682753, -0.07002039378945267, 0.1076096776029093, 0.33569592484931265, 0.5868069639900075, 0.8309400340211434, 1.0384886865627723, 1.183173310997621, 1.244647450533085, 1.2105245922715404, 1.0776268352993166, 0.8523330028235301, 0.5499919122634659, 0.19345802243818205, -0.18910741756486077, -0.5669546966137493, -0.9097175755197503, -1.190348129459021, -1.3877274297491855, -1.4886967232590167, -1.489310488520463, -1.3951889096385939, -1.2209354571216948, -0.9886767702786968, -0.7258679417034504, -0.46257820157283475, -0.22852285028765182, -0.05013211481495907, 0.052056023206067524, 0.06542370581683167, -0.013476818622928932, -0.17857354995264904, -0.41485972268979915, -0.6998562152349448, -1.0058082682621639, -1.3024015031870837, -1.5597313825081398, -1.7512354287472023, -1.8563011478174922, -1.862294330770876, -1.7658091293451994, -1.5730174633434328, -1.2990834663914634, -0.9667001825358553, -0.6038916323034168, -0.24129526423730402, 0.09080934119218671, 0.3654348215972054, 0.561496370321082, 0.6658427219598536, 0.6745091659275279, 0.5930701294024275, 0.4360570181572678, 0.22549850844279268, -0.011273611882316629, -0.244338058411229, -0.4441512768906914, -0.5844776109828279, -0.6449953685701459, -0.6133234711080304, -0.48627009083463313, -0.27018084204283843, 0.019647760128679807, 0.3604323553158629, 0.724101185065034, 1.080011912553215, 1.3979229464535174, 1.6509275750828358, 1.8180638457771903, 1.8863448523323614, 1.8520108146473921, 1.7208804972150387, 1.5077676615784874, 1.2350197538131784, 0.9303219343429818, 0.6239814549470069, 0.3459582389142699, 0.12293234738997927, -0.024304612126237204, -0.08287880528576443, -0.049085608037662896, 0.07125928828856001, 0.26340340706390547, 0.5051184506449528, 0.7688955935325236, 1.0246601033946585, 1.2427394396900644, 1.3967941543557314, 1.4664245478772293, 1.4391977618947862, 1.311896710636422, 1.0908684157109625, 0.791437456902447, 0.43644175708081273, 0.05403382503108304, -0.32503752310643913, -0.6703990927382829, -0.954988192761518, -1.157663401245273, -1.2652358726515438, -1.2737225649382777, -1.1886989266687047, -1.0247167320377046, -0.8038442570180032, -0.5534718954765633, -0.3035982111037671, -0.08386227159538207, 0.07938706183566858, 0.16569784401699797, 0.16254243529308632, 0.0665669715246409, -0.11605952391641952, -0.37023067793106873, -0.67336574288858, -0.9976068924763233, -1.3125358258149828, -1.588143818307025, -1.7977645325891864, -1.9206825320529766, -1.9441621675319147, -1.8646982292524217, -1.6883659188048887, -1.430235844473653, -1.1129112492644002, -0.7643305872311611, -0.41505046121818273, -0.09527478615210783, 0.16807913102089855, 0.3539905309148885, 0.44936582329628916, 0.45029127292734505, 0.3623852928603632, 0.20021603533128202, -0.01415852515742779, -0.25338491718536443, -0.4875279106843061, -0.6870378228819694, -0.825680720887274, -0.8831444782023832, -0.8470653697214364, -0.7142766103347394, -0.4911564039033849, -0.19304121686988168, 0.15723850437352843, 0.5315570481728407, 0.8992115639054524, 1.2298937296970331, 1.4966242657455027, 1.6783632260428976, 1.7620407289897473, 1.7438095085213234, 1.6293968297107873, 1.433521461143862, 1.1784329021695894, 0.8917159692693443, 0.6035757432379392, 0.3438687298942096, 0.13917091406599089, 0.010169759470743998, -0.030364519024132848, 0.021170196238594827, 0.1588574030850046, 0.3678460824182992, 0.6258122224418354, 0.9051546556846998, 1.1757102047301893, 1.4077222834018726, 1.5747722750152713, 1.6563866383000563, 1.640064419589714, 1.5225265711857927, 1.3100646382309487, 1.0179545247316975, 0.6689925550545748, 0.29129695312632226, -0.08441024131251754, -0.42777494946086675, -0.7117458267810758, -0.9151849642069934, -1.0248991754039802, -1.0368932485372595, -0.9567227025324438, -0.7989117353460756, -0.585493556805511, -0.34381620397814566, -0.10382883378037741, 0.10488566210127787, 0.25604104849512827, 0.329254100448338, 0.3120716022212628, 0.2012193943952731, 0.002951032969617721, -0.2675382287539327, -0.5875749204015337, -0.9292051772461855, -1.2619118900323816, -1.5555853172734782, -1.7834564702022957, -1.924706209577379, -1.966494721629279, -1.9052127618954955, -1.7468322183374052, -1.5063216937188821, -1.2061843132494194, -0.8742608698004114, -0.5410133165773475, -0.23655446823012075, 0.012285401559902426, 0.18456800511924837, 0.2672771937537732, 0.25657120355382995, 0.15813453973307107, -0.013404808026828505, -0.23593562250157232, -0.4820580868086105, -0.7217977860214114, -0.9255732357694013, -1.067126265526255, -1.1261282128450139, -1.0902066123173801, -0.9561937838420494, -0.7304748866848523, -0.4284011535673847, -0.07282552413038411, 0.30809619756536805, 0.6836236403232673, 1.0234037467271442, 1.3004055406615123, 1.493530712782204, 1.58964468276286, 1.5848295180522556, 1.4847362510185174, 1.3040022844932346, 1.064791081358659, 0.7945972397930895, 0.5235319530903694, 0.28135470385798, 0.09454186930726065, -0.016320712875620872, -0.03856589480997354, 0.031304518866494054, 0.18726983888388998, 0.4143751862602834, 0.6901936066773199, 0.9870224924457389, 1.2745993046374113, 1.5230707388633284, 1.7059246530974608, 1.802597705028601, 1.8005033745174581, 1.6962817681666713, 1.496148765575243, 1.215310215308004, 0.8764983944607683, 0.5077738517898867, 0.13980765168766526, -0.19709011291880268, -0.4759048439550901, -0.6755279306067732, -0.7827878701009326, -0.7937033962641825, -0.7138361565411661, -0.5577086254416292, -0.3473444471732737, -0.11007430536473976, 0.12417768571972894, 0.3258612239618245, 0.4687300254936898, 0.5324479513906728, 0.5046157391134563, 0.382019743043036, 0.17098024972610187, -0.1132349194165996, -0.44787430066724077, -0.8049010539035715, -1.1537105839063129, -1.4641016497692267, -1.70921026976767, -1.8681193579337902, -1.9278887565556413, -1.8848070501864278, -1.7447427093173447, -1.522560260394894, -1.2406586848464007, -0.9267751560620427, -0.6112691208536053, -0.32415258302656524, -0.09215727379449129, 0.06387423332236551, 0.13101813160159692, 0.10552110221829923, -0.006848303978737136, -0.19138292868636836, -0.4258977129243993, -0.6829247445035378, -0.932427646570782, -1.1447694582893877, -1.2936433333555055, -1.3586790108187758, -1.3274697404126194, -1.196821065635971, -0.9730990299622688, -0.6716435195478273, -0.3153039611686635, 0.06775950031780423, 0.44679432392224905, 0.7914275225908831, 1.0746005439698831, 1.275180012569712, 1.3799889912644423, 1.3850601407288659, 1.2959883173218576, 1.1273482978337748, 0.9012348249273185, 0.6450680728649129, 0.3888795302197368, 0.16234414697194252, -0.0081505798698754, -0.10211153536266727, -0.10696761004011149, -0.019319416916107002, 0.1547113378503426, 0.4000671238733925, 0.6942172842017222, 1.0093550465431027, 1.3151138372804847, 1.5815370383958443, 1.78201050234269, 1.8958707690136203, 1.9104336570867082, 1.822244623525836, 1.637428447653256, 1.371103944769, 1.0459209202564086, 0.6898624813324027, 0.3335277210611803, 0.007160640208489554, -0.2622840005969795, -0.4537508332626287, -0.5541147004776865, -0.5594335209270772, -0.47530074365373404, -0.3162630808026482, -0.10436071253064319, 0.13306693723120394, 0.366094859227039, 0.5651797067432917, 0.704089962191193, 0.7625119798945851, 0.7280765897209287, 0.597607666625221, 0.37747023269599117, 0.0829838056673907, -0.26304178740654693, -0.6325050076766843, -0.9947305934372451, -1.3194410710769569, -1.5796910931170423, -1.7544775371228598, -1.8307700270793867, -1.804763260038858, -1.682228683281115, -1.4779312156361635, -1.2141682125000357, -0.9185737802762023, -0.6214034434815046, -0.3525650188254508, -0.13868637763647565, -0.000507150913118835, 0.049150294840557766, 0.006632002311077258, -0.12219675944019309, -0.3225353067685577, -0.5721087796529442, -0.8433636994312823, -1.106182843551661, -1.3308535856336823, -1.4909990239318123, -1.5661848502249696, -1.5439466390761836, -1.4210389586361538, -1.2037838665043328, -0.9074845023738128, -0.5549609947688839, -0.1743518049852433, 0.203604471649172, 0.5485409765996053, 0.833397434065437, 1.037030902937475, 1.1462470926510366, 1.1570536212287599, 1.075012755461311, 0.9146593208352133, 0.6980409739849842, 0.45252393597271945, 0.2080791815719742, -0.005685069784541383, -0.1624538892072085, -0.24181215509696005, -0.23127173338272541, -0.12752072304217552, 0.06322767034609138, 0.3258209234387672, 0.6376304325581337, 0.970749081469465, 1.2947081255714175, 1.5794475293757844, 1.7982490690187019, 1.9303451406106018, 1.9629479433483399, 1.8925004278020938, 1.7250265624497005, 1.4755466201233942, 1.1666146920532916, 0.826121543484579, 0.48457782239671116, 0.17214348392029763, -0.08430587993743972, -0.2637887428398017, -0.3532480427827592, -0.3488036603777066, -0.25610452113374743, -0.08974601297339768, 0.12819008544311897, 0.37033006532644314, 0.6067221410209606, 0.8078038500207081, 0.9473323281716355, 1.0049904169328645, 0.9684132869684927, 0.8344369830262394, 0.6094464568322522, 0.30878880235901995, -0.04469108719405494, -0.4228493161782666, -0.7949612161138555, -1.1306931373802969, -1.4030371064575824, -1.5909212806915198, -1.68124086015121, -1.6701108371682254, -1.563218126395078, -1.3752387664590273, -1.1283773900129892, -0.8501720650460646, -0.5707795076989035, -0.3200065177919034, -0.1243783152495846, -0.004530828437521222, 0.02681774074319401, -0.03388253033199635, -0.180663058972709, -0.39862115601378706, -0.6653818436379635, -0.9532939820005323, -1.2321456989108255, -1.4721332677116952, -1.6467927533928082, -1.7356073760206097, -1.7260352686186997, -1.6147590280096689, -1.4080346196316251, -1.1211053457319236, -0.7767380921130285, -0.4030249746084895, -0.030665403687933433, 0.31000556371217325, 0.5919518894264559, 0.794047168294844, 0.9031058500550929, 0.9151364477214495, 0.8356942726798436, 0.6792993841377101, 0.46797694548107166, 0.22906308536524672, -0.007508742010210995, -0.21217505275443058, -0.3586726142911989, -0.4266446683576539, -0.4036677796096126, -0.2865007135112436, -0.08143290834617847, 0.19630174678813955, 0.523988611747203, 0.8736303519932106, 1.2146643354238478, 1.5169335033395546, 1.7536200242599715, 1.9038546682642368, 1.954746567562499, 1.9026347504299934, 1.7534389982485858, 1.5220757239653786, 1.230996076288776, 0.9079893802456181, 0.5834669223039333, 0.2874919393817537, 0.04684649814474995, -0.11757767611125679, -0.1928090878550147, -0.17504846339682759, -0.07002039378945284, 0.10760967760290925, 0.33569592484931277, 0.5868069639900075, 0.8309400340211435, 1.0384886865627723, 1.183173310997621, 1.244647450533085, 1.2105245922715402, 1.0776268352993166, 0.8523330028235302, 0.549991912263466, 0.1934580224381822, -0.18910741756486069, -0.5669546966137491, -0.90971757551975, -1.190348129459021, -1.387727429749185, -1.4886967232590165, -1.4893104885204627, -1.3951889096385939, -1.2209354571216946, -0.9886767702786964, -0.7258679417034503, -0.4625782015728346, -0.22852285028765199, -0.05013211481495921, 0.052056023206067496, 0.06542370581683167, -0.013476818622928705, -0.17857354995264882, -0.4148597226897988, -0.6998562152349448, -1.0058082682621639, -1.3024015031870833, -1.5597313825081396, -1.7512354287472023, -1.8563011478174924, -1.862294330770876, -1.7658091293451998, -1.573017463343433, -1.2990834663914634, -0.9667001825358554, -0.6038916323034167, -0.24129526423730402, 0.0908093411921868, 0.36543482159720553, 0.5614963703210821, 0.6658427219598536, 0.674509165927528, 0.5930701294024273, 0.43605701815726766, 0.22549850844279234, -0.01127361188231697, -0.24433805841122933, -0.4441512768906917, -0.5844776109828281, -0.6449953685701456, -0.6133234711080304, -0.4862700908346332, -0.27018084204283843, 0.019647760128679692, 0.3604323553158627, 0.724101185065034, 1.080011912553215, 1.3979229464535174, 1.6509275750828356, 1.8180638457771903, 1.8863448523323614, 1.852010814647392, 1.7208804972150389, 1.5077676615784872, 1.2350197538131782, 0.930321934342982, 0.6239814549470069, 0.34595823891426974, 0.1229323473899791, -0.02430461212623743, -0.08287880528576466, -0.04908560803766295, 0.07125928828856001, 0.2634034070639052, 0.5051184506449529, 0.7688955935325235, 1.0246601033946585, 1.2427394396900646, 1.3967941543557316, 1.466424547877229, 1.4391977618947864, 1.311896710636422, 1.090868415710962, 0.7914374569024472, 0.43644175708081284, 0.05403382503108307, -0.32503752310643913, -0.670399092738283, -0.9549881927615181, -1.157663401245273, -1.2652358726515438, -1.2737225649382777, -1.1886989266687047, -1.0247167320377044, -0.8038442570180028, -0.5534718954765632, -0.3035982111037671, -0.08386227159538226, 0.07938706183566831, 0.16569784401699802, 0.16254243529308632, 0.06656697152464096, -0.11605952391641938, -0.3702306779310686, -0.6733657428885801, -0.9976068924763235, -1.3125358258149828, -1.588143818307025, -1.7977645325891862, -1.920682532052977, -1.9441621675319152, -1.864698229252422, -1.6883659188048892, -1.4302358444736532, -1.1129112492644007, -0.7643305872311611, -0.4150504612181829, -0.09527478615210777, 0.16807913102089875, 0.3539905309148885, 0.4493658232962894, 0.45029127292734505, 0.3623852928603631, 0.20021603533128177, -0.01415852515742796, -0.2533849171853645, -0.48752791068430623, -0.6870378228819694, -0.8256807208872738, -0.8831444782023827, -0.8470653697214364, -0.7142766103347393, -0.4911564039033849, -0.19304121686988185, 0.15723850437352838, 0.5315570481728406, 0.8992115639054523, 1.2298937296970334, 1.4966242657455024, 1.6783632260428976, 1.7620407289897473, 1.7438095085213234, 1.6293968297107873, 1.433521461143862, 1.1784329021695896, 0.8917159692693445, 0.6035757432379394, 0.3438687298942095, 0.13917091406599089, 0.010169759470743828, -0.030364519024133188, 0.021170196238594657, 0.15885740308500462, 0.36784608241829925, 0.6258122224418355, 0.9051546556846999, 1.1757102047301893, 1.4077222834018726, 1.5747722750152713, 1.6563866383000563, 1.6400644195897134, 1.5225265711857925, 1.3100646382309484, 1.0179545247316975, 0.668992555054575, 0.29129695312632237, -0.08441024131251743, -0.4277749494608667, -0.7117458267810756, -0.9151849642069934, -1.02489917540398, -1.0368932485372593, -0.9567227025324436, -0.7989117353460752, -0.5854935568055109, -0.3438162039781456, -0.10382883378037752, 0.1048856621012776, 0.25604104849512815, 0.329254100448338, 0.3120716022212629, 0.20121939439527342, 0.0029510329696180405, -0.2675382287539327, -0.5875749204015336, -0.9292051772461858, -1.2619118900323818, -1.555585317273478, -1.7834564702022955, -1.9247062095773795, -1.9664947216292787, -1.9052127618954955, -1.7468322183374052, -1.5063216937188826, -1.2061843132494199, -0.8742608698004113, -0.5410133165773476, -0.23655446823012058, 0.012285401559902603, 0.1845680051192483, 0.2672771937537734, 0.2565712035538301, 0.15813453973307084, -0.013404808026828618, -0.2359356225015725, -0.4820580868086106, -0.7217977860214116, -0.9255732357694014, -1.0671262655262552, -1.1261282128450134, -1.09020661231738, -0.9561937838420494, -0.7304748866848523, -0.42840115356738484, -0.07282552413038411, 0.30809619756536777, 0.6836236403232673, 1.023403746727144, 1.3004055406615123, 1.493530712782204, 1.58964468276286, 1.5848295180522556, 1.4847362510185176, 1.3040022844932344, 1.0647910813586592, 0.7945972397930898, 0.5235319530903696, 0.28135470385798006, 0.0945418693072607, -0.016320712875620983, -0.0385658948099736, 0.03130451886649399, 0.1872698388838901, 0.41437518626028347, 0.6901936066773201, 0.987022492445739, 1.2745993046374116, 1.5230707388633284, 1.705924653097461, 1.802597705028601, 1.8005033745174581, 1.6962817681666713, 1.496148765575243, 1.2153102153080042, 0.8764983944607685, 0.5077738517898865, 0.13980765168766537, -0.1970901129188024, -0.4759048439550899, -0.6755279306067731, -0.7827878701009323, -0.7937033962641824, -0.7138361565411658, -0.557708625441629, -0.3473444471732737, -0.11007430536473976, 0.12417768571972886, 0.3258612239618243, 0.4687300254936897, 0.5324479513906727, 0.5046157391134563, 0.3820197430430362, 0.17098024972610198, -0.1132349194165995, -0.44787430066724077, -0.8049010539035715, -1.1537105839063129, -1.4641016497692265, -1.70921026976767, -1.8681193579337905, -1.927888756555641, -1.884807050186428, -1.744742709317345, -1.5225602603948942, -1.240658684846401, -0.9267751560620427, -0.6112691208536053, -0.32415258302656524, -0.0921572737944912, 0.06387423332236543, 0.13101813160159695, 0.105521102218299, -0.006848303978737271, -0.19138292868636847, -0.4258977129243997, -0.6829247445035378, -0.932427646570782, -1.1447694582893881, -1.2936433333555057, -1.3586790108187756, -1.3274697404126192, -1.196821065635971, -0.9730990299622686, -0.6716435195478272, -0.3153039611686633, 0.06775950031780406, 0.44679432392224916, 0.7914275225908831, 1.0746005439698834, 1.275180012569712, 1.3799889912644425, 1.3850601407288659, 1.2959883173218578, 1.1273482978337748, 0.901234824927319, 0.6450680728649133, 0.38887953021973726, 0.1623441469719427, -0.008150579869875288, -0.1021115353626675, -0.10696761004011143, -0.019319416916106946, 0.15471133785034277, 0.4000671238733926, 0.6942172842017226]

    valid_array = np.array(valid_list)

    test_array = denoise(f, 100, timestep)

    assert len(test_array) != 0, "The test array is empty"
    assert len(test_array) == len(valid_list), "The test array is of a different length than the valid array"
    assert np.allclose(valid_array, test_array), "The test and valid array are not equal"