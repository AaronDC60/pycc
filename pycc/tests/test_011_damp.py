#Import required packages
from numpy.testing._private.utils import jiffies
from pycc.rt.utils import damp
import numpy as np
import pytest

def test_damp():
    #Define function
    np.random.seed(10)
    timestep = 0.001
    t = np.arange(0, 1, timestep)
    f = np.cos(2*np.pi*12*t) + np.sin(2*np.pi*50*t)
    f = f + np.random.randn(len(t))

    #The below list is the confirmed dampened value for the above function
    valid_list = [2.3315865041295183, 2.0214413927130943, 0.031036291099145692, 1.7751245143876875, 2.527189642309918, 1.2096506028105587, 2.1158887163122584, 1.7814058030721587, 1.4155337837065634, 0.9128243142470578, 1.1619173536360046, 1.5692381058775815, -0.9349165134060171, 0.776065438176661, -0.22967760704514004, -0.12907018794041297, -1.7310621929308638, -0.3888167850568668, 1.1086258163857727, -1.2508731355098817, -1.9146824531146893, -1.4467187865986824, 0.7658918806951169, 3.0308823889599927, 1.837954676405553, 2.3632113175557516, 0.6703104393956327, 1.758313630438622, -0.19786533114553176, 0.34458185021434445, -0.9045602482801908, -1.5516586050427075, -1.2007619120895103, -2.0786920453920974, -0.4800026625386423, -1.6809011447822315, -1.460601912200172, -2.0848688580311463, -0.2932663565683534, -2.0203161982562503, -0.33179465971404926, -1.0403074640992822, -1.3509539766775682, -0.6750776894791767, -0.8378531541956131, -0.1812264237560115, -0.33507926136509103, 0.20089212725982336, 0.26471675022054103, -0.6891725786625453, -0.8346440701268248, -0.7820993425955133, -1.8385625220035542, -0.7571751477123206, -0.7064823815271147, -1.3317575969979714, 0.972580052084812, -0.29435261732864415, -1.0324779660026868, -0.9316724179098844, -0.4193957786622151, -0.3054440509191071, 1.6781864289676074, 0.14883462290249722, 0.9823714827553591, 0.6578001250963164, 2.257087542356555, -0.2765959165533129, 0.6279077887888104, 0.6575127099562985, 0.8547842236748517, 0.7494360733128462, -0.14691885089385126, 0.8911573382125605, 0.12607755992037215, 2.2755300013202273, -1.6075688137561335, 0.6993610199631608, -0.7123154420894119, -0.1598433007416739, 2.952092883088853, 3.036755186604075, -0.27329976662045247, 1.5850501807568962, 1.882890910987404, -0.13951832437863756, 1.8810023068058077, 2.163130903209938, 1.7427615349953036, -0.7748109471082381, 1.9828248629288896, 0.7725861778321853, 0.1442046442190005, -0.816462446025411, 0.4542710403016248, 0.5553413136624833, -0.8550295576440557, -0.2048573307540769, 0.6871475034064437, -1.882507154032714, 0.42620842171974166, -1.3610241651895187, -0.1723695961753029, 1.3656815349806655, 0.8186879726688059, 0.5366953102467485, 0.5169169555905244, 1.4441879385574934, 1.0088697967586449, -0.8340575085328903, -0.1327411874942544, -1.2716102475727729, 1.2587245385374444, -2.1646020647130753, -1.937744835915466, -2.0762581373884097, -2.1668686941830733, -1.49028255008803, -1.1777325019762566, -2.8247511353701373, -1.5016880163664144, -1.9647095911252128, 0.8487730894340996, 2.2838168338656044, 1.3360249416542604, 0.34594470794150145, 0.9755938801234573, -0.01281362987595536, 1.2688917542330829, 0.022023110440286625, -1.1587184716986039, -2.3359325015768486, -2.0898314126505424, -1.3175503244225486, -2.9527158605479786, -1.949006868055016, -0.2862034056992692, -1.396291034822156, 0.8399517661072884, 0.6448234514026171, -0.712743167723256, -1.405383775602083, 0.2544836393472144, 0.11611179829261317, 1.189876481682865, 2.549152082865013, -0.1593263259263724, 0.5076425105609466, 1.0817045584889164, 1.6788207073814092, 0.8189120840961504, 0.4845716945588402, 1.2039267896850112, 0.1987350434933558, -0.6098615513497042, -0.30497555580846547, -0.9634721253127865, 0.4830830969052144, 1.147496222471027, -2.448488951058561, 2.092222635584765, 1.1613550516828226, 1.9852623208168243, 2.430775798946767, -0.363793794886039, 0.7953100674377132, 1.6149041608981802, 1.0161784373478715, 1.854830476116512, 0.7777945973435173, -0.7416470262470327, 1.248954003675358, 1.4309342234229026, 0.642730270941743, -0.8119190987025785, -0.45131564199871543, 0.35939212676369764, 0.5051213380821551, 1.0743859473319477, -0.005531413946674234, -0.8839922926948884, 0.10065262444657667, 1.522727799603682, 1.883511656183736, 3.432734257026601, 1.3029547658586402, 1.3069058530112467, 0.6685743452911888, 0.14418471716805822, 0.9767043767287373, 0.16588604376234828, -0.7761490604334274, -1.9977434319315348, -1.3332766718469822, -1.8103996687378614, -0.2802884513362809, -0.601049536450317, -2.4846481274437733, -0.13197823479766146, -1.64125747211251, -0.6749789253553962, 0.6598815525633611, -1.3233208909658016, 0.049117792205996054, -1.1249860539466574, -1.9072744517395583, 0.9517819867728571, -0.15748917022213824, -1.2325562046628502, -2.273102326337241, -1.391637863235898, 0.05323230469684157, -1.1457233964861928, -2.117503277933352, -2.529574488300666, -1.7679587061481614, -3.331089722721922, -0.2578276218415884, -0.8293310453558257, 0.1914006532276535, -1.19916958847743, 0.5854099076447055, 0.7601246268254577, -1.1706932150641303, 0.7191633688369974, 1.0045861638761784, 0.1394296229185536, 0.28577589316168955, 0.9346975317163797, 0.25813867978426075, -0.9404826534399439, 0.4195797323590229, -0.14773210940412934, -0.2743925197665621, -0.49810375258221945, -0.12500298624273573, -0.7431610221136739, -1.1131395266788058, -0.7106220626603695, 1.4695476043516849, -1.2866896739332006, 1.6254064237044794, -0.030931090258703844, 0.06398630690429222, 0.8425215890013089, 1.66951376045258, 2.632108308959574, 0.08500229025605022, 3.245142802093157, 2.465802962621991, 0.8659819007594471, 0.39723084122322067, -0.5517382259023291, 0.7522805550219062, 0.07248665114911836, 1.3395615988300298, -0.7366086607854977, 0.6018183503912979, 0.1990221947962012, -0.37691956920327696, 2.626715746900511, 1.2617578249033499, 1.82271291298197, 0.29680404948088035, 0.7198949935209606, 1.507253678585785, 0.7217322310691561, 1.6930422287219127, 1.2359474015029164, -0.334934720747978, 0.2552666100202557, -0.31698491854607996, -0.8381904419596066, -2.116610684872959, -2.01937192682013, -1.0965540729151588, -0.31626851129862327, -2.22348819832183, 0.11474391715789672, -0.7026342034392072, -1.9036867143082352, -0.061131754229036585, 0.7262523258628034, 0.27889460951800643, 2.42805432301108, 0.43154028717452236, 0.9317363717597508, -0.11846728211983461, 0.6046696277823209, -3.0605078090020954, -1.8460647056090378, -1.6687914394745869, -1.0814352959368627, -1.6124839997990479, -0.8487286377347225, -1.6084776421029607, -1.6874919819753733, -1.8706059101807726, -1.3094134945473481, -0.3298408532780837, -0.053609709712409984, 0.425206070409276, -0.3629751975254163, -0.5415304097829504, -0.11800914201370455, 0.811996873662324, 2.0875469356515075, 0.6441301553731699, 0.738450493118909, -1.6071151489617415, 2.487383086076358, -1.5222361335037962, 1.1898297522420938, -1.324607253748878, 0.1192611933482542, 0.0025965375559005638, -0.624578444733797, -0.6412462213820905, -1.1232048713936817, 0.1078628037488364, 1.6334745327467561, 1.2763102942272524, 0.36013609841409466, 2.6728425211584343, 0.5087454578669911, 2.0144866832349315, 0.9088866143227469, 0.9124743323546802, 2.582095417812785, 0.791536405271947, -0.5452915562238951, 0.13652720569711996, 1.1612146209846999, -0.5375373690233369, 1.2596551332621986, 0.9981659395854894, 0.10185313826605423, 1.323765687026084, 2.208917233733591, -1.3794264920322246, 2.028392705365269, 1.7518402536298048, 1.0561636181499228, 2.2140351934144564, 2.0367594866363685, 1.058868927484172, 3.009896769690737, 1.4603212746020098, 2.2193303985589705, 0.4420210693184749, -1.3234779029226313, 0.1718774270821055, -0.6586827929012531, -1.9773347958785412, -2.6242578428937575, -0.44528450909122047, 0.18041577939320888, 0.37541931025532815, -0.3377724395013347, -0.6597459515167775, -0.23579286676838906, -0.1386016919686098, 0.8236048766974675, -0.30125344397954923, -0.9834765629843516, 0.051645285358387985, 0.36896506458700556, -0.2691367631429748, -0.24971718178848604, 1.6066210274202783, -0.045297011849526225, -2.644156099989265, -0.9063991511898671, -3.964406948011945, -1.3259563161085666, -1.5189635373263237, -1.917306810729143, -2.760427810781188, -2.539632305085363, -0.8492004640031197, -1.5401746101215175, 0.24606771175581743, -0.8974687067944983, -0.37673863624101644, 0.9296825096514064, 0.2364965853387615, 0.10904205255653898, 0.45954265389041477, 0.4051658013674013, -0.26693244815179756, -0.19913451890808465, -0.779275642060549, -0.45999840139265696, -0.7312951645264969, -0.5830418601717522, -0.2578432797490345, -1.9639071246451423, -2.0733685741471684, -0.6898172067719859, -0.24316312001126736, 0.7693482119733797, -0.5296416409646028, 1.2254526895848914, 1.7541876624551214, -0.10602896015759218, 2.0667734358913465, 3.034305230349121, 1.6750737098688318, 0.4889923791136936, 0.5681005583214591, 0.7991704246837014, 0.07909550924863151, -2.845626009074782, 1.611279168199045, -0.43689658528690667, -0.18638861038753382, 0.9697349438297523, 0.4247295689403219, -0.08121585371310337, 0.580940768781733, 1.4997792767561762, 1.8018955764764422, 1.3127965118070026, 2.4848339496847873, 2.5798448195371892, 1.317554213641324, 0.7056273324977897, 1.842874513739689, 1.8182240503456129, 0.44571984613261534, 0.09972459379199813, 0.6959529091829109, -0.027783700734657208, 0.8800476148358826, -0.17436453959937526, 1.566955172199702, -0.3081129790453156, -1.6626198198238522, -0.8208850649539253, -0.515837315890468, -1.8623563016633435, 0.7227556552840512, 0.3147646569229968, 0.38193970770396507, -0.07275018390358903, -0.640048401647762, 0.13561281668804293, -0.7208398316289598, -0.11263209853422775, -1.3556084701195261, -2.21810589597092, -1.0621049637701894, -1.2782634474482484, -1.182437397571783, -1.836252897293485, -0.5014049187136359, -2.5637842993887414, -0.692350206078392, -2.572236029235193, -1.98401504024321, -1.3970929075134655, -0.915495380574731, 1.150061051491855, -0.7767539495856056, -1.2242720355956764, 0.8758500427386177, 0.08934204611197295, -1.5377209781401575, 0.18760942798382807, 0.5559870792393452, -1.0197007333272157, 0.6715072365831493, 0.44154538940626237, -1.9429514210673182, -0.46484590330633935, -3.3960377029128703, -1.0140378273634643, -1.7239927887529622, 0.29124438818155773, -1.1922945992484537, 1.0871464687641494, -0.3549423347879951, 0.37029715254828843, 0.33753181886562905, 1.523043004837078, 0.05249509806005847, 2.0837797994157325, 0.6901464799688612, 3.436313689043286, 0.7354611661533684, -0.03452275267773762, 0.9471287026856464, -0.5941000101507516, 0.6459690763146451, -0.49878503071852603, 0.4160970357048804, 0.05992428031657552, 0.7089414884895644, -0.28132037286284084, 0.029027870700774557, 2.4311364191014806, 2.679358500654995, 2.489412238757858, 1.206603709320501, 3.1703000380775115, 1.5955636623217546, 1.6983820793554723, 2.7221605842393504, 1.2958413847407657, 1.045045950075956, 0.4052250252392467, -0.2984315270294072, -0.6722471195854176, -0.6038354559495769, -0.30535361405284894, -0.8754101383250265, -1.767408651578938, -0.670814375906592, -0.5988035498234828, -0.10072322395689537, 0.5130759980601444, 0.5884726967264805, -0.32643797404276786, -0.18145760128801103, 0.2212757143090462, -0.06042557524521228, -1.0135429988195646, -0.10771782080237746, -1.353001790625998, -1.5266590499810961, -1.8710498856876168, -2.0485216562019164, -2.457193815399727, -2.505036386271825, -2.0415435944942755, -1.0578723459555028, -3.1970593654583976, -0.6857630943108618, -1.0216014652299006, -0.7526735532391666, -1.2411963598335753, -0.4958062327091354, 0.15047814455011255, 0.4399215440921759, -0.37210449122782735, 0.7658083222001809, 1.2024761445560324, 0.8562166370211922, 0.4020559933932619, -1.1427749854697242, -0.8013627263908004, -0.9210360714406217, -1.755388317069467, -1.2424549471419792, -1.3751197247212137, -1.5799672660396273, -1.5658517334125654, -1.2426286202988053, -0.8836947955430742, -0.9329512062584, -0.6093137126536067, 0.14476851142575042, -0.5715138451506273, -1.0068647885810897, 0.8442077730557527, 0.008146070876015757, 2.8459003383140886, 1.8582283400901392, 2.2303792704715297, 1.5067203501344328, 0.2139893505803037, 0.7867822301693981, 0.5865020172545358, -1.469732032912063, 0.5938199361342428, -1.0831307034698543, -1.2735003240665752, 0.8171574740943596, -0.23947816709745798, -0.32167994829220486, 2.1481787846782203, -0.470756737975547, 0.80917889909812, 2.9215658511917035, 4.603520586155923, 2.048555236425102, 2.8333054532844133, 0.771015304540155, 3.5874772693051713, 0.6264716529948353, -1.9320800568893104, 0.6355464793871584, 0.3475002623102834, -0.8437691067848925, 0.0002067044336161731, 0.9465844947178247, -1.7156786579798822, 0.20474288989198217, -1.1195166362032714, 1.550537323349519, 0.8761986359040892, 0.03251027989372375, 1.0220945917985556, 0.5055502463894573, 1.6056734248430975, 0.9091068061738062, 2.1131987883823506, 3.2464235475149397, 0.6428812881746324, 0.8218916180623128, -0.04818593103370113, -1.3030849923598942, -0.658950727946826, -0.44813544935242117, -0.7763636101573078, -1.565883568556171, -1.8763193310622792, 0.1967864428914449, -0.5204487020647407, 0.17339820571969192, -1.5755122501920054, 0.7737956404930197, -1.8379488122421619, 0.29677900845969035, -0.016632255562247743, 0.16113996888350626, -0.45512263836480493, 0.7480674181108032, 0.15089396082883022, -0.4487689652858667, 1.1310886696576943, -0.16567143920633734, -1.2630573432359848, -1.6371148658126833, -3.7009471923147297, -2.3597899675142737, -2.098865792108917, -2.2283054264136806, -1.2482140370585082, 1.0147044564858563, 0.08791474876657744, -0.28085957128918104, -0.7794693702337941, 1.542131057776446, 0.580376904184178, 2.7951522718731865, 1.1165286474596656, 2.3204741216843656, 1.2177896151048744, 0.618493100364235, 0.4332802393345081, 0.6933284585993988, -0.16560328658106857, -1.853937067804875, -2.248509082898812, -1.0753821234672056, -1.0706470366966185, 0.14565586850530626, 0.0752533869546997, 1.0170183206420438, 0.6506713478644273, 1.7731644437782752, 1.856367580401479, 2.8622384749883447, 1.0260599147452183, 0.09069797844450143, 1.3230517308664007, 2.5259376360527983, 0.9201890073757243, 0.8109219740358552, -0.3191129807768093, -0.33461807049908676, 0.13772566770114655, -1.660151108828912, -0.24991361470939827, -0.17228279517009096, -0.38519464730498315, 0.027042516558447045, -0.5922673136882965, 1.5633689377925855, 1.3220593371387879, -0.011329473810507357, 0.9099400676209083, 0.4754294857021736, 2.4724186729708464, 1.0629630331901092, -0.13644029480781114, 1.6851565540258706, 1.1560104395372028, -0.007408362009630583, -0.7082895009746889, -0.9838896164799142, -0.9779987519679397, -2.2603049535628084, 0.3817149692714066, -1.6024083004865397, 0.6528877603346334, -1.908801832284376, -1.501752450690559, -1.3597924429592305, 0.09702134499350017, 0.4551449833113019, 0.01496292070503718, 1.021784610863275, 1.1566134445300793, 1.0263421957073837, -0.44784361688641255, -1.323457803863093, -2.0287474313036604, -2.1383780582097067, -1.301763768031128, -2.5656179615592554, -1.6503207631749315, -0.25331058685314056, -2.0076767473891906, -3.7500342432456835, -0.9437030216508032, -1.8194882574794975, -1.8243929488891255, -1.267597597116623, -1.9533910453658494, -0.24880875366403843, 0.8239252509305758, -0.6609753201413566, 1.1357159900801612, 1.2939243077513953, 0.14553624625009318, 1.6475712579708883, -0.6555940544824368, 0.7326144563736318, -0.08035988214675881, -0.2524738726731515, 0.012737566362134257, -0.30870080243524345, -2.544680668651394, -1.861936954023559, -1.5313931707546986, -0.48579597878381015, 0.8061446655434432, 1.4181289480970045, 1.3938164109152167, 1.2563968395565663, 0.4388782216493571, 2.840188940460213, 1.9467184321279365, 0.6883317402831174, 1.2795954554864746, 2.986693147376611, 2.995364239555758, 0.36842214068054313, 3.0925366042544136, 1.591860373903534, 0.9641876392410202, -0.9989305534080777, 2.1449693439986794, -0.12282860945677214, -0.7993841005299543, -0.3769590640671258, 0.1302108969552221, -0.5183490884474033, 1.3361596112025111, 0.8627481996058471, -0.5240078241060795, 0.4895941467705835, 0.30751824648591475, 0.6148392759330469, 0.753960700910092, 1.274956723754275, 0.5025546080413753, 0.2585570398063684, -0.6829419336153958, 0.36339272454610866, -0.9478161725439295, 1.0131169477974822, -2.07048415623266, -1.3430723350157427, -0.03040883421099345, -2.3910781175102684, -2.042552214452471, -1.991877457368176, -0.763311522423021, -0.6742057316420194, 0.05508530733921646, 1.1271582505378979, -1.0374983226550216, -0.26040124328439385, 0.4379768968758168, -2.6273648291318783, -0.8961303945024383, -1.1207094966472824, -1.5888287682849125, -1.0184382816753068, -0.4877663946932477, -2.330193801314632, 0.2586033887405894, -2.6571068946960157, -1.9483874543092314, -1.504008061025233, -2.985033297257219, -0.6983894888502434, -0.7837824333558234, -0.2954719542953315, 0.9090304654723208, 0.19703949234007556, 1.4526804101904363, -0.8689399989868576, 0.22547107026403018, 1.6520782656448831, 0.17348352030219916, -1.1663592092348454, -1.336073089913517, -1.1728548223255422, -1.9274048650686937, -0.2744865481881115, -3.6334901018629067, -1.6251430124520692, -2.069576415786811, -1.839394222115401, -0.7503275464132227, -1.0674024826408008, 1.0078995068399779, 0.11680178965658188, 0.6883532012577878, 2.3452864218578675, 1.9753358069205105, 1.9246576887874103, 1.7664385566533, 0.5696618134785404, 1.799628471218438, 3.3561072995685577, 0.7017233920362863, -0.32602938828656847, -1.1044872165413864, -1.7217397161222605, -0.2940254738199795, -0.5452061858807639, 1.0679991081613522, 0.07266881465967752, 1.0067037125401859, 1.2176475959007593, 2.063321497127362, 0.8330802987532301, 2.338778381242069, 1.9947622287069173, 0.5787375593956613, 0.6088424617442455, 1.937286080041724, 1.002447748717999, -1.1679643521372898, 0.9402490262520111, 0.5663280474135209, 0.1249510135855926, 1.0944696767154174, -1.113090246396823, -2.4608353705307704, -0.4262051485262893, -0.9286294725346779, -0.4179525900137903, -0.22423274241283142, -0.512918726777296, -0.9715357231953703, -0.24778637578466106, -0.12647817350228105, -0.2636366367488742, 0.4301112316471496, 0.15036698377643581, 0.22006275503721887, -1.0983274715884161, -0.5585324015903681, -1.726886667348617, -1.9767763569805976, 0.11226303248331268, -2.5642113563054, -1.3044549057416406, -3.611190198643614, -2.0913284369872724, -0.9000520216606099, -1.0069087015403417, -2.2903558316332666, -0.4673933252654063, -1.2945750694171463, -1.5485921861743652, -1.4751082184846438, -2.010620040588429, 0.6383174963855164, 1.0405283310253644, 1.935325053151743, -0.15913876958504355, -0.2950382560558222, -0.738204160164837, -0.11283782090966962, -0.5057004856138678, -2.3637330527662024, -0.5406501850537199, -0.5147622971995816, -0.8039100614746872, -1.172703381782217, -2.62232391349698, -0.32201939750852787, -0.1782492437164666, -0.15602791363032228, 0.752032550356828, 0.8068353118997139, 1.3868209914812357, 1.4033843898011724, 1.1605422320331023, 0.5322766476899019, 0.3145907594944482, 1.712763930189855, 1.1028737963527646, 1.2755047921444362, 1.0313411969736261, 0.22069838577339196, 2.056110244167872, -0.4706016193059102, 0.05944458974731007, -0.45704996198182113, -0.16735042587678883, -0.6228070364936312, 1.3473126644378584, 0.43589886824541435, 1.90001033862369, 2.5563841135496315, 1.665607886292525, 1.262828011296716, 2.105753616462683, 2.2648602927817403, 2.1566294685563916, -0.08270489837352842, 2.397050107319078, -0.34086478784141566, -1.2109891573291502, 0.4277749457283997, -0.8156570292104008, -0.5771766553554395, -0.5936289069813148, 0.8766990330794744, -0.6180318309311175, -0.15481232495197877, -0.7564452966100782, -0.8867179943341184, 0.9045092138940658, 0.8375390843474878, 1.969034985025048, -0.2887117464401549, 0.8302072220417208, 1.1175509899994083, -1.506659295326143, -1.3891118440871988, 0.03849789691751872, -0.573550746640365, -1.7873362488294418, -0.5614148687515724, -2.6081011919595642, -3.3175602004277795, -1.8716461285662855, -1.791995246018895, -0.8522148350731337, -1.354563173679087, -0.4712169646937608, -1.9485929646472049, 0.1920978327137173, -1.40955655964384, 0.8923745910168127, -0.15487861059897243, 0.11478470366994159, -0.2986614348281213, -0.1130559579489515, -0.47416572788818706, -1.8341629075466859, -1.45638620793576, -1.5021358792900137, -0.8300426302320968, -0.7266566174455126, -1.6283203744519519, -0.9189863419359637, -0.7320848681494444, -1.2727727353401561, -3.089634890482249, -0.28483745745071853, 1.5069313457505527, -0.09283997314341964, 1.529895826595315, 0.38322665915653314, 0.6454919781881413, 3.513728421000443, 1.3618356352702436, 0.4207220050890965, 2.3352214307492547, 1.2867144112884912, 1.113727516732394, -1.4157641329248787, -0.1050671475029889, 0.12385748069631058, -0.2106080688454087, -1.0773922327116923, -0.3258488843377607, 1.595566757079198, 0.010578014809088578, 1.321760228280376]

    valid_array = np.array(valid_list)
    test_array = damp(f, timestep, 150)

    assert len(test_array) != 0, "The test array was empty"
    assert len(test_array) == len(valid_array), "The length of the test and the valid array are not equal"
    assert np.allclose(valid_array, test_array), "The test and valid array are not equal"
